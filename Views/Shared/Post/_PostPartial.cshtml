@using System.Security.Claims
@using SimpleSocialApp.Data.Enums
@using SimpleSocialApp.Models.ViewModels.Posts
@model PostViewModel
@{
    var currentUserId = User.FindFirstValue(ClaimTypes.NameIdentifier);
}

<div class="post card shadow-sm mb-4">
    <div class="post-header card-header d-flex justify-content-between align-items-center">
        <div class="post-user">
            <h5 class="mb-0">@Model.Post.User.UserName</h5>
            <span class="text-muted small">@Model.Post.CreatedDateTime.ToString("MMM dd, yyyy")</span>
        </div>
        @if (Model.Post.UserId == currentUserId)
        {
            <div class="post-actions">
                <a href="@Url.Action("Edit", "Post", new { postId = Model.Post.Id })" class="btn btn-outline-primary btn-sm mx-1">
                    <i class="bi bi-pencil"></i> Edit
                </a>
                <a href="@Url.Action("Delete", "Post", new { postId = Model.Post.Id })" class="btn btn-outline-danger btn-sm mx-1">
                    <i class="bi bi-trash"></i> Delete
                </a>
            </div>
        }
    </div>

    <div class="post-content card-body">
        <p>@Model.Post.Content</p>

        <div class="post-media">
            @foreach (var media in @Model.Post.Media)
            {
                @if (media.Type == MediaOptions.Image)
                {
                    <div class="media-item mb-3">
                        <img src="@media.Url" alt="Post Image" class="img-fluid rounded shadow-sm" />
                    </div>
                }
                else if (media.Type == MediaOptions.Video)
                {
                    <div class="media-item mb-3">
                        <video controls class="w-100 rounded shadow-sm">
                            <source src="@media.Url" type="video/mp4" />
                            Your browser does not support the video tag.
                        </video>
                    </div>
                }
            }
        </div>
    </div>

    @if (ViewData["ShowActions"] as bool? ?? true)
    {
        <div class="post-footer card-footer bg-light d-flex justify-content-between align-items-center">
            <div class="actions">
                <span id="like-count-@Model.Post.Id" class="like-count"><i class="bi bi-hand-thumbs-up"></i> @Model.LikesCount Likes</span>
                <span class="comment-count"><i class="bi bi-chat-left"></i> @Model.CommentsCount Comments</span>
            </div>

            <div class="buttons">
                <button class="btn btn-outline-primary like-button" data-target-type="Post" data-target-id="@Model.Post.Id">
                    <i class="bi bi-hand-thumbs-up"></i> Like
                </button>
                @if (ViewData["IsCommentView"] as bool? ?? true)
                {
                    <a href="@Url.Action("Details", "Post", new { postId = Model.Post.Id })" class="btn btn-outline-secondary">
                        <i class="bi bi-chat-left-text"></i> Comments
                    </a>
                }
            </div>
        </div>
    }
</div>

<!-- Add Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

